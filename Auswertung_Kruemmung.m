%% Legende Ergebnis_Kr
% 01.   Messpunkt des minimalen Radius/maximalen Kruemmung der Gesamtkurve
% 02.   minimaler Radius der Gesamtkurve [m] (kleinster Radius definiert die Kurve)  
% 03.   Laenge des Abschnitts [m]
% 04.   0
% 05.   Messpunkt bei Kurvenbeginn
% 06.   Messpunkt bei 0.1 der Kurve (Distanz)
% 07.   Messpunkt bei 0.3 der Kurve (Distanz)
% 08.   Messpunkt bei 0.5 der Kurve (Distanz)
% 09.   Messpunkt bei 0.7 der Kurve (Distanz)
% 10.   Messpunkt bei Kurvenende
% 11.   Messpunkt bei der maximalen Querablage
% 12.   0
% 13.   0
% 14.   Querablage bei Kurvenbeginn  [m]
% 15.   Querablage bei 0.1 der Kurve (Distanz)
% 16.   Querablage bei 0.3 der Kurve (Distanz)
% 17.   Querablage bei 0.5 der Kurve (Distanz)
% 18.   Querablage bei 0.7 der Kurve (Distanz)
% 19.   Querablage bei Kurvenende
% 20.   maxmimale Querablage
% 21.   durchschnittliche Querablage
% 22.   0
% 23.   0
% 24.   0
% 25.   Spurbreite bei Kurvenbeginn  [m]
% 26.   Spurbreite bei 0.1 der Kurve (Distanz)
% 27.   Spurbreite bei 0.3 der Kurve (Distanz)
% 28.   Spurbreite bei 0.5 der Kurve (Distanz)
% 29.   Spurbreite bei 0.7 der Kurve (Distanz)
% 30.   Spurbreite bei Kurvenende
% 31.   Spurbreite bei maximaler Querablage
% 32.   durchschnittliche Spurbreite
% 33.   0
% 34.   normierte Querablage bei Kurvenbeginn
% 35.   normierte Querablage bei 0.1 der Kurve (Distanz)
% 36.   normierte Querablage bei 0.3 der Kurve (Distanz)
% 37.   normierte Querablage bei 0.5 der Kurve (Distanz)
% 38.   normierte Querablage bei 0.7 der Kurve (Distanz)
% 39.   normierte Querablage bei Kurvenende
% 40.   maxmimale normierte Querablage
% 41.   durchschnittliche normierte Querablage
% 42.   normierter Kurvenschneiderfaktor
% 43.   0
% 44.   0
% 45.   Kruemmung bei Kurvenbeginn  [1/m]
% 46.   Kruemmung bei 0.1 der Kurve (Distanz)
% 47.   Kruemmung bei 0.3 der Kurve (Distanz)
% 48.   Kruemmung bei 0.5 der Kurve (Distanz)
% 49.   Kruemmung bei 0.7 der Kurve (Distanz)
% 50.   Kruemmung bei Kurvenende
% 51.   Kruemmung bei maximaler Querablage
% 52.   maxmimale Kruemmung
% 53.   durchschnittliche Kruemmung
% 54.   0
% 55.   0
% 56.   Querbeschleunigung bei Kurvenbeginn  [m/s^2]
% 57.   Querbeschleunigung bei 0.1 der Kurve (Distanz)
% 58.   Querbeschleunigung bei 0.3 der Kurve (Distanz)
% 59.   Querbeschleunigung bei 0.5 der Kurve (Distanz)
% 60.   Querbeschleunigung bei 0.7 der Kurve (Distanz)
% 61.   Querbeschleunigung bei Kurvenende
% 62.   Querbeschleunigung bei maximaler Querablage
% 63.   maxmimale Querbeschleunigung
% 64.   minimale Querbeschleunigung
% 65.   durchschnittliche Querbeschleunigung
% 66.   0
% 67.   Geschwindigkeit bei Kurvenbeginn  [km/h]
% 68.   Geschwindigkeit bei 0.1 der Kurve (Distanz)
% 69.   Geschwindigkeit bei 0.3 der Kurve (Distanz)
% 70.   Geschwindigkeit bei 0.5 der Kurve (Distanz)
% 71.   Geschwindigkeit bei 0.7 der Kurve (Distanz)
% 72.   Geschwindigkeit bei Kurvenende
% 73.   Geschwindigkeit bei maximaler Querablage
% 74.   maxmimale Geschwindigkeit
% 75.   minimale Geschwindigkeit
% 76.   durchschnittliche Geschwindigkeit
% 77.   0
% 78.   0
% 79.   realtive Kurvendistanz bei Kurvenbeginn (immer 0)  [m]
% 80.   realtive Kurvendistanz bei 0.2 der Kurve (Distanz)
% 81.   realtive Kurvendistanz bei 0.4 der Kurve (Distanz)
% 82.   realtive Kurvendistanz bei 0.6 der Kurve (Distanz)
% 83.   realtive Kurvendistanz bei 0.8 der Kurve (Distanz)
% 84.   realtive Kurvendistanz bei Kurvenende (entspricht Kurvenlaenge)
% 85.   realtive Kurvendistanz bei maximaler Querablage
% 86.   0
% 87.   0
% 88.   Messpunkt der realtiven Kurvendistanz bei Kurvenbeginn
% 89.   Messpunkt der realtiven Kurvendistanz bei 0.2 der Kurve (Distanz)
% 90.   Messpunkt der realtiven Kurvendistanz bei 0.4 der Kurve (Distanz)
% 91.   Messpunkt der realtiven Kurvendistanz bei 0.6 der Kurve (Distanz)
% 92.   Messpunkt der realtiven Kurvendistanz bei 0.8 der Kurve (Distanz)
% 93.   Messpunkt der realtiven Kurvendistanz bei Kurvenende
% 94.   Messpunkt der realtiven Kurvendistanz bei maximaler Querablage
% 95.   0
% 96.   0
% 97.   Querablage bei Kurvenbeginn  [m]
% 98.   Querablage bei 0.2 der Kurve (Distanz)
% 99.   Querablage bei 0.4 der Kurve (Distanz)
% 100.  Querablage bei 0.6 der Kurve (Distanz)
% 101.  Querablage bei 0.8 der Kurve (Distanz)
% 102.  Querablage bei Kurvenende
% 103.  maxmimale Querablage
% 104.  durchschnittliche Querablage
% 105.   0
% 106.   0
% 107.   0
% 108.   Spurbreite bei Kurvenbeginn  [m]
% 109.   Spurbreite bei 0.2 der Kurve (Distanz)
% 110.   Spurbreite bei 0.4 der Kurve (Distanz)
% 111.   Spurbreite bei 0.6 der Kurve (Distanz)
% 112.   Spurbreite bei 0.8 der Kurve (Distanz)
% 113.   Spurbreite bei Kurvenende
% 114.   Spurbreite bei maximaler Querablage
% 115.   durchschnittliche Spurbreite  
% 116.   0
% 117.   normierte Querablage bei Kurvenbeginn
% 118.   normierte Querablage bei 0.2 der Kurve (Distanz)
% 119.   normierte Querablage bei 0.4 der Kurve (Distanz)
% 120.   normierte Querablage bei 0.6 der Kurve (Distanz)
% 121.   normierte Querablage bei 0.8 der Kurve (Distanz)
% 122.   normierte Querablage bei Kurvenende
% 123.   normierte maxmimale Querablage
% 124.   normierte durchschnittliche Querablage
% 125.   normierter Kurvenschneiderfaktor 
% 126.   0
% 127.   0
% 128.   Kruemmung bei Kurvenbeginn  [1/m]
% 129.   Kruemmung bei 0.2 der Kurve (Distanz)
% 130.   Kruemmung bei 0.4 der Kurve (Distanz)
% 131.   Kruemmung bei 0.6 der Kurve (Distanz)
% 132.   Kruemmung bei 0.8 der Kurve (Distanz)
% 133.   Kruemmung bei Kurvenende
% 134.   Kruemmung bei maximaler Querablage
% 135.   maxmimale Kruemmung
% 136.   durchschnittliche Kruemmung
% 137.   0
% 138.   0
% 139.   Querbeschleunigung bei Kurvenbeginn  [m/s^2]
% 140.   Querbeschleunigung bei 0.2 der Kurve (Distanz)
% 141.   Querbeschleunigung bei 0.4 der Kurve (Distanz)
% 142.   Querbeschleunigung bei 0.6 der Kurve (Distanz)
% 143.   Querbeschleunigung bei 0.8 der Kurve (Distanz)
% 144.   Querbeschleunigung bei Kurvenende
% 145.   Querbeschleunigung bei maximaler Querablage
% 146.   maxmimale Querbeschleunigung
% 147.   minimale Querbeschleunigung
% 148.   durchschnittliche Querbeschleunigung
% 149.   0
% 150.   Geschwindigkeit bei Kurvenbeginn  [km/h]
% 151.   Geschwindigkeit bei 0.2 der Kurve (Distanz)
% 152.   Geschwindigkeit bei 0.4 der Kurve (Distanz)
% 153.   Geschwindigkeit bei 0.6 der Kurve (Distanz)
% 154.   Geschwindigkeit bei 0.8 der Kurve (Distanz)
% 155.   Geschwindigkeit bei Kurvenende
% 156.   Geschwindigkeit bei maximaler Querablage
% 157.   maxmimale Geschwindigkeit
% 158.   minimale Geschwindigkeit
% 159.   durchschnittliche Geschwindigkeit
% 160.   0
% 161.   0
% 162.   realtive Kurvendistanz bei Kurvenbeginn (immer 0)       [m]
% 163.   realtive Kurvendistanz 0.2 der Kurve (20% der Distanz)  [m]
% 164.   realtive Kurvendistanz 0.4 der Kurve (40% der Distanz)  [m]
% 165.   realtive Kurvendistanz 0.6 der Kurve (60% der Distanz)  [m]
% 166.   realtive Kurvendistanz 0.8 der Kurve (80% der Distanz)  [m]
% 167.   realtive Kurvendistanz bei Kurvenende
%% Plots
%prinzipiell ist die Aussage evtl besser, wenn man die Kurvenlänge auch
%noch einheitlich betrachtet, wie bei den einzelnen Kurvenplots. Dafür muss
%man lediglich die ":" für die Reihen durch ein "n" ersetzen, und eine for
%Schleife von a:n laufen lassen. Ausgenommen sind die Plots fuer die
%Durchschnittswerte und die Regression, dort werden die ":" durch "a:z"
%ersetzt (Siehe folgendes Beispiel)

% % Kl=150;%Kurvenlaenge
% % Klb=2;%Kurvenlaengenberich
% % 
% % Ergebnis_Rechtskurve_0400_0450=sortrows(Ergebnis_Rechtskurve_0400_0450,3);
% % a=find(Ergebnis_Rechtskurve_0400_0450(:,3)>Kl-Klb,1,'first'); %Anfang 
% % z=find(Ergebnis_Rechtskurve_0400_0450(:,3)<Kl+Klb,1,'last');  %Ende

% % normierte maximale Querablage über Durchschnittsgeschwindigkeit
% % fig_4=figure ('Name','Qab_max_norm/v_durchschnitt_0400_0450');
% % title ('Normierte maximale Querablage über Durchschnittsgeschwindigkeit')
% % subtitle('Kurvenradius 400-450m')
% % grid on
% % hold on 
% % for n=a:z
% % scatter(mean(Ergebnis_Linkskurve_0400_0450(a:z,76)),mean(Ergebnis_Linkskurve_0400_0450(a:z,40)),200,'blue','filled')
% % scatter(mean(Ergebnis_Rechtskurve_0400_0450(a:z,76)),mean(Ergebnis_Rechtskurve_0400_0450(a:z,40)),200,'red','filled')
% % scatter(Ergebnis_Linkskurve_0400_0450(n,76),Ergebnis_Linkskurve_0400_0450(n,40),10,'blue','filled')
% % scatter(Ergebnis_Rechtskurve_0400_0450(n,76),Ergebnis_Rechtskurve_0400_0450(n,40),10,'red','filled')
% % % Regressionsgerade
% % Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(a:z,76)),1) Ergebnis_Linkskurve_0400_0450(a:z,76)];
% % regl=Xl\Ergebnis_Linkskurve_0400_0450(a:z,40);
% % plot(Ergebnis_Linkskurve_0400_0450(a:z,76),Xl*regl,'blue')
% % Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(a:z,76)),1) Ergebnis_Rechtskurve_0400_0450(a:z,76)];
% % regl=Xr\Ergebnis_Rechtskurve_0400_0450(a:z,40);
% % plot(Ergebnis_Rechtskurve_0400_0450(a:z,76),Xr*regl,'red')
% % end
% % xlabel ('durchschnittliche Geschwindigkeit')
% % ylabel ('normierte maximale Querablage')
% % legend ('Linkskurve','Rechtskurve')
% % hold off


% normierter Kurvenschneiderfaktor über normierten Offset
fig_1=figure ('Name','Kurvenschneiderfaktor/Offset_norm_0400_0450');
title ('Kurvenschneiderfaktor über normierten Offset zu Kurvenbeginn')
subtitle('Kurvenradius 400-450m')
grid on
hold on
scatter(mean(Ergebnis_Linkskurve_0400_0450(:,34)),mean(Ergebnis_Linkskurve_0400_0450(:,42)),200,'blue','filled')
scatter(mean(Ergebnis_Rechtskurve_0400_0450(:,34)),mean(Ergebnis_Rechtskurve_0400_0450(:,42)),200,'red','filled')
scatter(Ergebnis_Linkskurve_0400_0450(:,34),Ergebnis_Linkskurve_0400_0450(:,42),10,'blue','filled')
scatter(Ergebnis_Rechtskurve_0400_0450(:,34),Ergebnis_Rechtskurve_0400_0450(:,42),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(:,34)),1) Ergebnis_Linkskurve_0400_0450(:,34)];
regl=Xl\Ergebnis_Linkskurve_0400_0450(:,42);
plot(Ergebnis_Linkskurve_0400_0450(:,34),Xl*regl,'blue')
Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(:,34)),1) Ergebnis_Rechtskurve_0400_0450(:,34)];
regl=Xr\Ergebnis_Rechtskurve_0400_0450(:,42);
plot(Ergebnis_Rechtskurve_0400_0450(:,34),Xr*regl,'red')

xlabel ('normiertet Offset zur Kurvenbeginn')
ylabel ('Kurvenschneidefaktor')
legend ('Linkskurve','Rechtskurve')
hold off


% normierte maximale Querablage über Querbeschleunigung an der Stelle
fig_2=figure ('Name','Qab_max_norm/ypp_0400_0450');
title ('Normierte maximale Querablage über Querbeschleunigung an der Stelle')
subtitle('Kurvenradius 400-450m')
grid on
hold on 
scatter(mean(Ergebnis_Linkskurve_0400_0450(:,62)),mean(Ergebnis_Linkskurve_0400_0450(:,40)),200,'blue','filled')
scatter(mean(Ergebnis_Rechtskurve_0400_0450(:,62)),mean(Ergebnis_Rechtskurve_0400_0450(:,40)),200,'red','filled')
scatter(Ergebnis_Linkskurve_0400_0450(:,62),Ergebnis_Linkskurve_0400_0450(:,40),10,'blue','filled')
scatter(Ergebnis_Rechtskurve_0400_0450(:,62),Ergebnis_Rechtskurve_0400_0450(:,40),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(:,62)),1) Ergebnis_Linkskurve_0400_0450(:,62)];
regl=Xl\Ergebnis_Linkskurve_0400_0450(:,40);
plot(Ergebnis_Linkskurve_0400_0450(:,62),Xl*regl,'blue')
Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(:,62)),1) Ergebnis_Rechtskurve_0400_0450(:,62)];
regl=Xr\Ergebnis_Rechtskurve_0400_0450(:,40);
plot(Ergebnis_Rechtskurve_0400_0450(:,62),Xr*regl,'red')

xlabel ('Querbeschleunigung')
ylabel ('normierte maximale Querablage')
legend ('Linkskurve','Rechtskurve')
hold off


% normierte maximale Querablage über normiertem Offset
fig_3=figure ('Name','Qab_max_norm/Offset_norm_0400_0450');
title ('Normierte maximale Querablage über normiertem Offset')
subtitle('Kurvenradius 400-450m')
grid on
hold on 
scatter(mean(Ergebnis_Linkskurve_0400_0450(:,34)),mean(Ergebnis_Linkskurve_0400_0450(:,40)),200,'blue','filled')
scatter(mean(Ergebnis_Rechtskurve_0400_0450(:,34)),mean(Ergebnis_Rechtskurve_0400_0450(:,40)),200,'red','filled')
scatter(Ergebnis_Linkskurve_0400_0450(:,34),Ergebnis_Linkskurve_0400_0450(:,40),10,'blue','filled')
scatter(Ergebnis_Rechtskurve_0400_0450(:,34),Ergebnis_Rechtskurve_0400_0450(:,40),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(:,34)),1) Ergebnis_Linkskurve_0400_0450(:,34)];
regl=Xl\Ergebnis_Linkskurve_0400_0450(:,40);
plot(Ergebnis_Linkskurve_0400_0450(:,34),Xl*regl,'blue')
Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(:,34)),1) Ergebnis_Rechtskurve_0400_0450(:,34)];
regl=Xr\Ergebnis_Rechtskurve_0400_0450(:,40);
plot(Ergebnis_Rechtskurve_0400_0450(:,34),Xr*regl,'red')

xlabel ('normiertet Offset zur Kurvenbeginn')
ylabel ('normierte maximale Querablage')
legend ('Linkskurve','Rechtskurve')
hold off


% normierte maximale Querablage über Durchschnittsgeschwindigkeit
fig_4=figure ('Name','Qab_max_norm/v_durchschnitt_0400_0450');
title ('Normierte maximale Querablage über Durchschnittsgeschwindigkeit')
subtitle('Kurvenradius 400-450m')
grid on
hold on 
scatter(mean(Ergebnis_Linkskurve_0400_0450(:,76)),mean(Ergebnis_Linkskurve_0400_0450(:,40)),200,'blue','filled')
scatter(mean(Ergebnis_Rechtskurve_0400_0450(:,76)),mean(Ergebnis_Rechtskurve_0400_0450(:,40)),200,'red','filled')
scatter(Ergebnis_Linkskurve_0400_0450(:,76),Ergebnis_Linkskurve_0400_0450(:,40),10,'blue','filled')
scatter(Ergebnis_Rechtskurve_0400_0450(:,76),Ergebnis_Rechtskurve_0400_0450(:,40),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(:,76)),1) Ergebnis_Linkskurve_0400_0450(:,76)];
regl=Xl\Ergebnis_Linkskurve_0400_0450(:,40);
plot(Ergebnis_Linkskurve_0400_0450(:,76),Xl*regl,'blue')
Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(:,76)),1) Ergebnis_Rechtskurve_0400_0450(:,76)];
regl=Xr\Ergebnis_Rechtskurve_0400_0450(:,40);
plot(Ergebnis_Rechtskurve_0400_0450(:,76),Xr*regl,'red')

xlabel ('durchschnittliche Geschwindigkeit')
ylabel ('normierte maximale Querablage')
legend ('Linkskurve','Rechtskurve')
hold off


% normierte maximale Querablage über Krümmung
fig_11=figure ('Name','Qab_max_norm/Krümmung_0400_0450');
title ('normierter maximale Querablage über Krümmung')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
scatter(mean(Ergebnis_Linkskurve_0400_0450(:,51)),mean(Ergebnis_Linkskurve_0400_0450(:,40)),200,'blue','filled')
scatter(mean(Ergebnis_Rechtskurve_0400_0450(:,51)),mean(Ergebnis_Rechtskurve_0400_0450(:,40)),200,'red','filled')
scatter(Ergebnis_Linkskurve_0400_0450(:,51),Ergebnis_Linkskurve_0400_0450(:,40),10,'blue','filled')
scatter(Ergebnis_Rechtskurve_0400_0450(:,51),Ergebnis_Rechtskurve_0400_0450(:,40),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(Ergebnis_Linkskurve_0400_0450(:,51)),1) Ergebnis_Linkskurve_0400_0450(:,51)];
regl=Xl\Ergebnis_Linkskurve_0400_0450(:,40);
plot(Ergebnis_Linkskurve_0400_0450(:,51),Xl*regl,'blue')
Xr=[ones(length(Ergebnis_Rechtskurve_0400_0450(:,51)),1) Ergebnis_Rechtskurve_0400_0450(:,51)];
regl=Xr\Ergebnis_Rechtskurve_0400_0450(:,40);
plot(Ergebnis_Rechtskurve_0400_0450(:,51),Xr*regl,'red')

xlabel ('Krümmung')
ylabel ('normierte maximale Querablage')
legend ('Linkskurve','Rechtskurve')
hold off

%alle Einzelpunkte der Kurven eines Radiusbereiches werden zusammengeführt,
%um daraus Punktewolken erstellen zu können
ZsmKr_ypp2_Rk=[];
ZsmKr_ypp_Rk=[];
ZsmKr_Qab2_Rk=[];
ZsmKr_Qab_Rk=[];
ZsmKr_ypp2_Lk=[];
ZsmKr_ypp_Lk=[];
ZsmKr_Qab2_Lk=[];
ZsmKr_Qab_Lk=[];
for n=1:size(Ergebnis_Rechtskurve_0400_0450,1)
%Querbeschleunigung über Krümmung
ZsmKr_ypp2_Rk(1,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Rechtskurve_0400_0450(n,46:49) Ergebnis_Rechtskurve_0400_0450(n,128:134)];
ZsmKr_ypp2_Rk(2,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Rechtskurve_0400_0450(n,57:60) Ergebnis_Rechtskurve_0400_0450(n,139:145)];
ZsmKr_ypp2_Lk(1,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Linkskurve_0400_0450(n,46:49) Ergebnis_Linkskurve_0400_0450(n,128:134)];
ZsmKr_ypp2_Lk(2,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Linkskurve_0400_0450(n,57:60) Ergebnis_Linkskurve_0400_0450(n,139:145)];

%normierte Querablage über Krümmung
ZsmKr_Qab2_Rk(1,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Rechtskurve_0400_0450(n,46:49) Ergebnis_Rechtskurve_0400_0450(n,128:134)];
ZsmKr_Qab2_Rk(2,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Rechtskurve_0400_0450(n,35:38) Ergebnis_Rechtskurve_0400_0450(n,117:123)];
ZsmKr_Qab2_Lk(1,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Linkskurve_0400_0450(n,46:49) Ergebnis_Linkskurve_0400_0450(n,128:134)];
ZsmKr_Qab2_Lk(2,n/n+n*11-11:n/n+n*11-1)=[Ergebnis_Linkskurve_0400_0450(n,35:38) Ergebnis_Linkskurve_0400_0450(n,117:123)];

end
% Aufbereitung damit die Daten als Punktewolke geplottet werden können
ZsmKr_ypp_Rk=ZsmKr_ypp2_Rk';
ZsmKr_ypp_Lk=ZsmKr_ypp2_Lk';
ZsmKr_Qab_Rk=ZsmKr_Qab2_Rk';
ZsmKr_Qab_Lk=ZsmKr_Qab2_Lk';

% ersetzt alle Reihen in denen die Krümmung NaN ist mit 0 als Vorbereitung
% um diese im nächsten Schritt zu löschen. Die NaN Werte verhindern, dass
% eine Regressionsgerade gebildet werden kann
for n=1:size(ZsmKr_ypp_Rk,1)
    if isnan(ZsmKr_ypp_Rk(n,1))
       ZsmKr_ypp_Rk(n,:)=0;
    end
    
    if isnan(ZsmKr_ypp_Lk(n,1))
       ZsmKr_ypp_Lk(n,:)=0;
    end    
 
     if isnan(ZsmKr_Qab_Rk(n,1))
       ZsmKr_Qab_Rk(n,:)=0;
     end 
  
     if isnan(ZsmKr_Qab_Rk(n,2))
       ZsmKr_Qab_Rk(n,:)=0;
     end     
     
     if isnan(ZsmKr_Qab_Lk(n,1))
       ZsmKr_Qab_Lk(n,:)=0;
     end    

     if isnan(ZsmKr_Qab_Lk(n,2))
       ZsmKr_Qab_Lk(n,:)=0;
     end       
     
end

% löscht alle Reihen die nur aus 0en bestehen
ZsmKr_ypp_Rk=ZsmKr_ypp_Rk(any(ZsmKr_ypp_Rk,2),:);
ZsmKr_ypp_Lk=ZsmKr_ypp_Lk(any(ZsmKr_ypp_Lk,2),:);
ZsmKr_Qab_Rk=ZsmKr_Qab_Rk(any(ZsmKr_Qab_Rk,2),:);
ZsmKr_Qab_Lk=ZsmKr_Qab_Lk(any(ZsmKr_Qab_Lk,2),:);

%Verlauf Querbeschleunigung über Kruemmung
fig_12=figure ('Name','ypp_0400_0450/Krümmung_0400_0450');
title ('Verlauf Querbeschleunigung über Krümmung')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Krümmung')
ylabel ('Querbeschleunigung')
scatter(ZsmKr_ypp_Lk(:,1),ZsmKr_ypp_Lk(:,2),10,'blue','filled')
scatter(ZsmKr_ypp_Rk(:,1),ZsmKr_ypp_Rk(:,2),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(ZsmKr_ypp_Lk(:,1)),1) ZsmKr_ypp_Lk(:,1)];
regl=Xl\ZsmKr_ypp_Lk(:,2);
plot(ZsmKr_ypp_Lk(:,1),Xl*regl,'blue','LineWidth',3)
Xr=[ones(length(ZsmKr_ypp_Rk(:,1)),1) ZsmKr_ypp_Rk(:,1)];
regl=Xr\ZsmKr_ypp_Rk(:,2);
plot(ZsmKr_ypp_Rk(:,1),Xr*regl,'red','LineWidth',3)
hold off

%Verlauf normierte Querablage über Kruemmung  (Punktewolke)
fig_13=figure ('Name','Qab_0400_0450/Krümmung_0400_0450');
title ('Verlauf normierter Querablage über Krümmung')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Krümmung')
ylabel ('Querablage')
scatter(ZsmKr_Qab_Lk(:,1),ZsmKr_Qab_Lk(:,2),10,'blue','filled')
scatter(ZsmKr_Qab_Rk(:,1),ZsmKr_Qab_Rk(:,2),10,'red','filled')
%Regressionsgerade
Xl=[ones(length(ZsmKr_Qab_Lk(:,1)),1) ZsmKr_Qab_Lk(:,1)];
regl=Xl\ZsmKr_Qab_Lk(:,2);
plot(ZsmKr_Qab_Lk(:,1),Xl*regl,'blue','LineWidth',3)
Xr=[ones(length(ZsmKr_Qab_Rk(:,1)),1) ZsmKr_Qab_Rk(:,1)];
regl=Xr\ZsmKr_Qab_Rk(:,2);
plot(ZsmKr_Qab_Rk(:,1),Xr*regl,'red','LineWidth',3)
hold off




% Balkendiagramm zur Darstellung der Verteilung der Radien
fig_5=figure ('Name','Radienverteilung');
title ('Radienverteilung der durchfahrenden Kurven')
xlabel ('Radien')
ylabel ('Haeufigkeit')

hold on
Linkskurvenverteilung=  [25,75,125,175,225,275,325,375,425,475,525,575,625,675,725,775,825,875,925,975,1025,1075,1125,1175,1225,1275,1350,1450,1550,1650,1750,1850,1950;Lk_0020_0050 Lk_0050_0100 Lk_0100_0150 Lk_0150_0200 Lk_0200_0250 Lk_0250_0300,Lk_0300_0350,Lk_0350_0400,Lk_0400_0450,Lk_0450_0500,Lk_0500_0550,Lk_0550_0600,Lk_0600_0650,Lk_0650_0700,Lk_0700_0750,Lk_0750_0800,Lk_0800_0850,Lk_0850_0900,Lk_0900_0950,Lk_0950_1000,Lk_1000_1050,Lk_1050_1100,Lk_1100_1150,Lk_1150_1200,Lk_1200_1250,Lk_1250_1300,Lk_1300_1400,Lk_1400_1500,Lk_1500_1600,Lk_1600_1700,Lk_1700_1800,Lk_1800_1900,Lk_1900_2000]';
Rechtskurvenverteilung= [25,75,125,175,225,275,325,375,425,475,525,575,625,675,725,775,825,875,925,975,1025,1075,1125,1175,1225,1275,1350,1450,1550,1650,1750,1850,1950;Rk_0020_0050 Rk_0050_0100 Rk_0100_0150 Rk_0150_0200 Rk_0200_0250 Rk_0250_0300,Rk_0300_0350,Rk_0350_0400,Rk_0400_0450,Rk_0450_0500,Rk_0500_0550,Rk_0550_0600,Rk_0600_0650,Rk_0650_0700,Rk_0700_0750,Rk_0750_0800,Rk_0800_0850,Rk_0850_0900,Rk_0900_0950,Rk_0950_1000,Rk_1000_1050,Rk_1050_1100,Rk_1100_1150,Rk_1150_1200,Rk_1200_1250,Rk_1250_1300,Rk_1300_1400,Rk_1400_1500,Rk_1500_1600,Rk_1600_1700,Rk_1700_1800,Rk_1800_1900,Rk_1900_2000]';
l1=bar(Linkskurvenverteilung(1:26,1),Linkskurvenverteilung(1:26,2),1,'b','FaceAlpha', 1);
l2=bar(Linkskurvenverteilung(27:33,1),Linkskurvenverteilung(27:33,2),1,'b','FaceAlpha', 1);
r1=bar(Rechtskurvenverteilung(1:26,1),Rechtskurvenverteilung(1:26,2),1,'r','FaceAlpha', 0.8);
r2=bar(Rechtskurvenverteilung(27:33,1),Rechtskurvenverteilung(27:33,2),1,'r','FaceAlpha', 0.8);
hold off

legend ([l1 r1],{'Linkskurven','Rechtskurven'})






%% Vorbereitung fuer Verlauf verschiedener Parameter über die Kurvenlaenge
% sollen nur Kurven mit gleichen Radien und gleicher Kurvenlaenge verglichen
% werden

Kl=150;%Kurvenlaenge
Klb=2;%Kurvenlaengenberich

Ergebnis_Rechtskurve_0400_0450=sortrows(Ergebnis_Rechtskurve_0400_0450,3);
a=find(Ergebnis_Rechtskurve_0400_0450(:,3)>Kl-Klb,1,'first'); %Anfang 
z=find(Ergebnis_Rechtskurve_0400_0450(:,3)<Kl+Klb,1,'last');  %Ende

%Zwischenmatrix für die Speicherung aller Einzelpunkte und Parameter einer
%Kurve und Sortierung, um den Punkt der maximalen Querablage einzureihen
ZsmQab=[];
ZsmKr=[];
ZsmQbe=[];
ZsmGe=[];


%da die Punkte in der Ergebnismatrix an verschiedenen Stellen abgespeichert
%wurden, müssen diese hier erstmal wieder zusammengeführt werden
for n=a:z
%normierte Querablage   
ZsmQab(:,(1+2*n-a)-a:(1+2*n-a)-a+1)=sortrows([Ergebnis_Rechtskurve_0400_0450(n,163:166) Ergebnis_Rechtskurve_0400_0450(n,79:85); Ergebnis_Rechtskurve_0400_0450(n,35:38) Ergebnis_Rechtskurve_0400_0450(n,117:123)]',1);
%Kruemmung
ZsmKr(:,(1+2*n-a)-a:(1+2*n-a)-a+1)=sortrows([Ergebnis_Rechtskurve_0400_0450(n,163:166) Ergebnis_Rechtskurve_0400_0450(n,79:85); Ergebnis_Rechtskurve_0400_0450(n,46:49) Ergebnis_Rechtskurve_0400_0450(n,128:134)]',1);
%Querbeschleunigung
ZsmQbe(:,(1+2*n-a)-a:(1+2*n-a)-a+1)=sortrows([Ergebnis_Rechtskurve_0400_0450(n,163:166) Ergebnis_Rechtskurve_0400_0450(n,79:85); Ergebnis_Rechtskurve_0400_0450(n,57:60) Ergebnis_Rechtskurve_0400_0450(n,139:145)]',1);
%Geschwindigkeit
ZsmGe(:,(1+2*n-a)-a:(1+2*n-a)-a+1)=sortrows([Ergebnis_Rechtskurve_0400_0450(n,163:166) Ergebnis_Rechtskurve_0400_0450(n,79:85); Ergebnis_Rechtskurve_0400_0450(n,68:71) Ergebnis_Rechtskurve_0400_0450(n,150:156)]',1);
end






%Verlauf Querbeschleunigung über Kurvenlaenge
fig_6=figure ('Name','ypp_0400_0450/Kurvenlaenge_0400_0450');
title ('Verlauf Querbeschleunigung über Kurvenlänge')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Kurvenlänge')
ylabel ('Querbeschleunigung')
for n=1:2:size(ZsmQbe,2)
plot(ZsmQbe(:,n),ZsmQbe(:,n+1))
end
hold off

%Verlauf Kruemmung über Kurvenlaenge
fig_7=figure ('Name','Krümmung_0400_0450/Kurvenlaenge_0400_0450');
title ('Verlauf Krümmung über Kurvenlänge')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Kurvenlänge')
ylabel ('Krümmung')
for n=1:2:size(ZsmKr,2)
plot(ZsmKr(:,n),ZsmKr(:,n+1))
end
hold off

%Verlauf normierte Querablage über Kurvenlaenge
fig_8=figure ('Name','Qab_norm_0400_0450/Kurvenlaenge_0400_0450');
title ('Verlauf normierter Querablage über Kurvenlänge')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Kurvenlänge')
ylabel ('Querablage')
for n=1:2:size(ZsmQab,2)
plot(ZsmQab(:,n),ZsmQab(:,n+1))
end
hold off

%Verlauf Geschwindigkeit über Kurvenlaenge
fig_9=figure ('Name','v_0400_0450/Kurvenlaenge_0400_0450');
title ('Verlauf Geschwindigkeit über Kurvenlänge')
subtitle('Rechtskurve - Kurvenradius 400-450m')
grid on
hold on 
xlabel ('Kurvenlänge')
ylabel ('Geschwindigkeit')
for n=1:2:size(ZsmGe,2)
plot(ZsmGe(:,n),ZsmGe(:,n+1))
end
hold off

